### CWE 弱點分類與摘要

我將您提供的 CWE 分為以下幾個主要類別：

#### 1. 注入與不當的輸入處理 (Injection & Improper Input Handling)
這是最大的一類，核心問題都是**將「不可信的外部輸入」當作「可信的指令或結構」來處理**，而沒有進行適當的驗證、過濾 (Sanitization) 或編碼 (Encoding)。

*   **CWE-020 (總覽):** 不當的輸入驗證。這是此分類的 overarching (總括性) 弱點，許多其他弱點都是它的具體實例。
*   **CWE-022:** 路徑遍歷 (Path Traversal)。輸入是檔案路徑，特殊字元 (`..`, `/`) 未被過濾，導致可存取任意檔案。
*   **CWE-078:** 作業系統命令注入 (OS Command Injection)。輸入被拼接到作業系統命令中執行。
*   **CWE-079:** 跨網站指令碼 (XSS)。輸入被拼接到 HTML/JavaScript 中，在使用者瀏覽器上執行。
*   **CWE-095:** 程式碼注入 (Code Injection)。輸入被當成伺服器端程式碼 (如 PHP `eval`) 來執行。
*   **CWE-113:** HTTP 回應分割 (HTTP Response Splitting)。輸入被注入到 HTTP 標頭中，可控制回應內容。
*   **CWE-117:** 日誌注入 (Log Injection)。輸入被寫入日誌檔，攻擊者可透過偽造日誌來掩蓋行蹤或誤導管理員。
*   **CWE-643:** XPath 注入 (XPath Injection)。輸入被拼接到 XPath 查詢中，可竊取或竄改 XML 文件內容。
*   **CWE-943:** 廣義查詢注入 (Improper Neutralization in Data Query Logic)。類似 SQL Injection，但針對 NoSQL、ORM 或 LDAP 等不同資料儲存的查詢。

#### 2. 密碼學應用不當 (Improper Cryptography Application)
這組弱點都與加密功能的實作錯誤有關，即使使用了加密，錯誤的配置或使用方式也會讓保護失效。

*   **CWE-326:** 加密強度不足。使用的金鑰太短 (如 RSA 1024) 或演算法迭代次數不夠。
*   **CWE-327:** 使用已遭破解或有風險的加密演算法。例如使用 MD5、SHA1 進行密碼雜湊，或使用 DES 加密。
*   **CWE-329:** 使用寫死或可預測的初始化向量 (IV)。這會讓加密模式 (如 CBC) 的安全性大幅降低。
*   **CWE-347:** 未正確校驗加密簽章。只解析資料而不驗證簽章的真實性，等於讓任何人都可以偽造資訊。
*   **CWE-760:** 使用可預測鹽值 (Salt) 的單向雜湊。例如所有使用者的密碼都用同一個 Salt，使得彩虹表攻擊依然有效。

#### 3. 資源管理與阻斷服務 (Resource Management & Denial of Service)
這類弱點可能導致應用程式效能下降、無回應，甚至崩潰。

*   **CWE-400:** 不受控制的資源消耗。攻擊者可透過特定請求（如上傳超大檔案、發起大量運算）耗盡伺服器資源（CPU、記憶體、頻寬）。
*   **CWE-1333:** 低效率的正規表示式複雜度 (ReDoS)。一個精心設計的字串就可能讓正規表示式引擎陷入災難性的回溯 (Catastrophic Backtracking)，耗盡 CPU 資源。

#### 4. 不安全的資料處理與物件操作
這類弱點涉及對特定資料結構或物件處理不當而產生的風險。

*   **CWE-502:** 對不信任資料的反序列化 (Insecure Deserialization)。攻擊者可構造惡意的序列化物件，在反序列化過程中觸發任意程式碼執行。
*   **CWE-377:** 不安全的暫存檔案 (Insecure Temporary File)。在檔案的「檢查」和「使用」之間存在時間差 (TOCTOU)，攻擊者可利用此空檔替換檔案，導致權限提升或程式碼執行。

#### 5. 存取控制與行為控制 (Access & Behavior Control)
這類弱點與權限設定和控制伺服器行為有關。

*   **CWE-732:** 對關鍵資源的不正確權限指派。檔案或目錄權限過於寬鬆（例如，設定檔可被任意使用者寫入）。
*   **CWE-918:** 伺服器端請求偽造 (SSRF)。應用程式被誘騙向內部網路或其他任意網址發出請求，可用於探測內網、攻擊內部服務。
